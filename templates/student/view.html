{% extends 'base.html' %}

{% block title %}
    {{ course.title }}
{% endblock %}

{% block content %}
    <div class="container-fluid">
        <div class="row">
            <div class="col" style="padding: 0;">
                <div id="video" class="text-center">
                    {% include 'hx/lesson/lesson_video.html' %}
                </div>
                <div class="d-flex justify-content-between">
                    <div><h5><i class="bi bi-search"></i></h5></div>
                    <div hx-get="{% url 'course:overview' course.id %}" hx-target="#content">
                        <h5>Visão geral</h5>
                    </div>
                    <div hx-get="{% url 'question:course' course.id %}" hx-target="#content">
                        <h5>Perguntas e respostas</h5>
                    </div>
                    <div><h5>Notas</h5></div>
                    <div><h5>Avaliações</h5></div>
                </div>
                <div id="content">
                    {% include 'hx/course/course_overview.html' %}
                </div>
            </div>
            {% include 'student/course/accordion.html' %}
        </div>
    </div>
    <div id="modal">
    </div>
{% endblock %}

{% block javascript %}
    <script>
        const opens = document.querySelectorAll('.open');

        opens.forEach(open => {
            open.addEventListener('click', () => {
                setTimeout(() => {
                    const modal = document.getElementById('modal_container');
                    modal.classList.add('show');
                    const close = document.getElementById('close');
                    close.addEventListener('click', () => {
                        const modal = document.getElementById('modal_container');
                        modal.classList.remove('show');
                    });
                }, 300)
            });
        })

        document.body.addEventListener('htmx:afterRequest', () => {
            let lesson_element = document.getElementById('lesson_id')
            document.lesson_id = lesson_element.getAttribute('data-value')
            let course_slug = "{{ course.slug }}"
            window.history.pushState("", "", `/students/course/${course_slug}/lesson/${document.lesson_id}/`);
        });


    </script>
{% endblock %}
